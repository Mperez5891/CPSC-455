<!DOCTYPE html>
<html>

    <title>Bank_Account.js</title>

    <body style = "background-color: lightblue;">

        <h1 style = "text-align: centered; font-size: 40px; border-style: double dashed; border-color: red;"> WELCOME TO SECURE BANKING WITH BANK.JS </h1>

        <h2> Customer Information </h2>

          <div class="customerInfo">

            <p id="name">Name</p>

          </div>


        <h2> Select Account </h2>


          <label for="customerAccount">Pick An Account</label>
            <select id="customerAccount" name="customerAccount" required/>
                <!--Insert Options List -->
            </select>
          <button type="button" onclick="getCurrentAccount()"> Confirm </button>


        <h2> Account Details </h2>


        <div class="functions">

          <p id="acct"> Account Name </p> <br>
          <p id="bal"> Account Balance </p> <br>

        </div>

        <div class="transactions">

          <form action="http://localhost:3000/deposit" method="post">
              <label for="deposit">Enter Deposit Amount</label><br>
              <input type="number" id="dep" name="amt"
                min="0.01" max="500" step=".01" required/> <br>
              <input type="submit" value="Submit"><br><br>
          </form> <br>

          <form action="http://localhost:3000/withdraw" method="post">
              <label for="deposit">Enter Withdraw Amount</label><br>
              <input type="number" id="with" name="amt"
                min="0.01" max="500" step=".01" required/> <br>
              <input type="submit" value="Submit"><br><br>
          </form> <br>


        </div>

        <h2> Customer Account Management </h2>
        <h3> Transfer Money To Another Account </h3>

        <div class="alert alert-info text-center">


            <form id="list" action="http://localhost:3000/transfer" method="post">

              <label for="transferFrom"> Transfer From Account </label>
                <select name="transferFrom" id="transferFrom" required/>
                    <!--Insert Options List -->
                </select>


              <br> <br>

              <label for="transferTo"> Transfer To Account </label>
                <select name="transferTo" id="transferTo" required>
                    <!--Insert Options List -->
                </select>

              <br> <br>

              <label for="transferAmount">Enter Transfer Amount</label><br>
                <input type="number" id="tAmt" name="tAmt"
                  min="0.01" max="500" step=".01" required/> <br>

              <input type="submit" value="Submit" onclick="getTransferInputs()"/>

            </form>
            <br> <br>

            <h3> Add Another Account </h3>

            <form action="http://localhost:3000/addAccount" method="post">

              <label for="customer"> Customer </label>
                <select name="customer" id="customer" required/>
                    <!--Insert Options List -->
                </select> <br>

              <input type="radio" id="yes" name="adding" value="yes">
              <label for="yes">Yes</label><br>

              <input type="radio" id="no" name="adding" value="no" checked="checked"/>
              <label for="no">No</label><br>

              <input type="submit" value="Add">
            </form>

        </div>


        <script>

          let currIndex = 0;

          function getCurrentAccount(){
            let inputValue = document.getElementById("customerAccount").value;
            alert('Selection: ' + inputValue);
          };

          //validation - if/else statement to see if overdrawn
          function getTransferInputs(){

            let transferFromAccount = document.getElementById("transferFrom").value;
            let transferToAccount = document.getElementById("transferTo").value;
            let transferAmount = document.getElementById("tAmt").value;

            alert('Transfer from ' + transferFromAccount + ' to ' + transferToAccount
                  + ' $' + transferAmount);

          }

          //hard coding data
          //let val ={name:"Andrew Test", aNum:"12345", tBal:"$123.45"};

          //test values with an array of objects
          /*
          let testArray = [];

          let accountInfo = {
            name:"Cedric",
            accountName:"first account",
            totAmount:100
          };

          testArray.push(accountInfo);

          accountInfo = {
            name:"Cedric",
            accountName:"second account",
            totAmount:345
          };

          testArray.push(accountInfo);

          accountInfo = {
            name:"Cedric",
            accountName:"third account",
            totAmount:589
          };

          testArray.push(accountInfo);

          let chosenAcct = 2;
          let currIndex = chosenAcct;


          //show test array
          console.log(testArray[currIndex].name)

          let arr = testArray;
          */



            fetch("http://localhost:3000/jsonData/")
              .then(function(response) {

                //below returns if passed object is json
                console.log(response);
                return response.json();
              })
              .then(function(values) {
                console.log(values);

                //taken out for testing
                //let objValues = values;

                //arr is just the values object 
                let arr = values;

                document.getElementById('name').innerHTML
                    = "Name: " + values[currIndex].name;

                document.getElementById('acct').innerHTML
                    = "Account Name: " + values[currIndex].accID;

                document.getElementById('bal').innerHTML
                    = "Total Balance: $" + values[currIndex].amount;

                //hardcoded array to fill pick list
                //let arr = objValues.customerAccounts;


                //aVal is array of values to fill and param2 is where to placeList
                function fillSelection(aVal, location){

                let placeHolder =  document.getElementById(location)

                //insert none value
                let noneChoice = document.createElement("option");
                noneChoice.text = "Choose";
                noneChoice.value= "";
                placeHolder.appendChild(noneChoice);

                  for (let i=0; i < aVal.length; i++){
                    let pickValue = aVal[i].accountName;
                    let elem = document.createElement("option");
                    elem.text = pickValue;
                    elem.value = pickValue;

                    placeHolder.appendChild(elem);
                  }

                };

                fillSelection(arr,'customerAccount');
                fillSelection(arr,'transferTo');
                fillSelection(arr, 'transferFrom');

                fillSelection(arr, 'customer');




              }).catch(function(error){
                  console.error(error);

          });

        </script>



    </body>

</html>
